Expected Market behavior - Эта функция имеет две характеристики:

1. Каждый индикатор предназначен для того что бы ловить те или иные движения на рынке и каждого индикатора мы должны добавить тип поведения рынка для которого он предназначен. Когда клиент выберет поведения рынка мы отфильтруем только те индикаторы которые подходят под данное поведение рынка которое хочет поймать клиент.

2. Для того что бы пересчетать раздел Score Board нам надо сделать следующее:
Мы будем использовать функцию ZigZag, и с её помощью будем считать количество раз про которых рынок вёл себя относительно указанному поведению:
    1. Breakout - Когда есть движение больше 7.5 процентов (все параметры для 3 поведений рынка должны управляться из админки). Для каждого breakout мы будем вычисляться его размер (в процентах) и протяжённость его по времени.
    2. Reversal - Данное поведение происходит всегда после breakout и считается точно так же как и breakout. Для того что бы Reversal был засчитан он должен быть не меньше чем 1/3 по величине (управляемый параметр) от своего breakout.
    3. Range    - Breakout и Reversal которые чередуют друг друга но не превышают значения в 7.5% считаются категорией Range. Мы будем считать каждый подъем и спуск, их количество, их изменения в процентах, их протяжённость.

Из всех вышеперечисленных параметров мы считаем оценки (суммируем общее количество) по каждого из нами собираемых асетов и составляемую гистограмму.


***

> Следующий вопрос возник. Вот, мы сосчитали гистограммы по breakouts/reversals/ranges для некоторого ассета. Как из гистограммы получить одну цифру "score”?

У каждого значения на исторгаем есть его сила и время, каждый столбик это сумма значений в 
диапазоне умные умноженных на 1/t. То есть, у нас есть вес у каждого значения в зависимость от 
времени его появления, ближайшие значение получают более высокие коэффициенты.

Конечный расчет будем следующим, мы даем высокие оценки большим значениям в гистогаме и маленькие низким 
значениям. Например: для гистограмы брейкаута в наивысшем интервале (40+) есть 7 происшествий  всего интервалов 4 ( 10-20, 20-30, 30-40, 40+),  мы умножаем 7 (количество происшествий на 4 (7*4) + количество происшествие в диапазоне с 30-40 на 3 итд. 

Результаты мы по всем ассетам сортируем и нормализуем от 0 до 100.



> Вижу два возможных варианта:
> - взять высоту самого первого пика (т.е., насколько много в истории ассета было "самых значимых" элементов с точки зрения анализируемого поведения);
> - взять сумму высот нескольких первых пиков с учетом их "весов" (взвешенная оценка, у четом менее значимых элементов).

> ???

> И, также важно — как сравнивать оценки для ассетов с разной длиной истории? 

> Могу предложить три варианта:

> - брать последний месяц (или другой интервал времени);
> - брать взвешенную сумму по нескольким последним интервалам;
> - брать усреднение по всей истории (м.б., с ограниченим на последний год или два).

> В любом случае, также надо решить, что делать с "совсем свежими" ассетами —  от какой минимальной длины истории надо считать оценку?

У нас клиент выбирает длину истории и если у нас нет данных по аскету за весь этот промежуток то кассета в таблице не будет.

